#!/usr/bin/env bash

INPUT_FILE="$1"
TMP_DIR=$(mktemp -d)

# Extract the file extension from the input file
EXTENSION="${INPUT_FILE##*.}"
TRIMMED_FILE="$TMP_DIR/trimmed.$EXTENSION"

trap "rm -rf '$TMP_DIR'" EXIT

ffmpeg -y -t 60 -i "$INPUT_FILE" -acodec copy "$TRIMMED_FILE" -loglevel quiet
PYTORCH_JIT=0 PYTHONWARNINGS="ignore" whisper "$TRIMMED_FILE" --model base --language English --output_format txt --output_dir "$TMP_DIR"
