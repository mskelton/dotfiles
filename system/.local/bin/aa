#!/usr/bin/env bash
# Approve and auto-merge a PR
# Usage: aa [-R <repo>] [branch]

while [[ $# -gt 0 ]]; do
	case $1 in
	-R)
		repo="$2"
		shift 2
		;;
	*)
		branch="$1"
		shift
		;;
	esac
done

# Set repo if -R was not specified
if [[ -z "$repo" ]]; then
	repo=$(gh repo view --json nameWithOwner --jq '.nameWithOwner')
fi

gh pr review --approve -R "$repo" "$branch"
auto-merge -R "$repo" "$branch"
